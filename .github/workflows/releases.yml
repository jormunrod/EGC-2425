name: Automatic Release

on:
push:
branches:
- main

permissions:
  contents: write

jobs:
release:
runs-on: ubuntu-22.04

steps:
- name: Checkout repository
uses: actions/checkout@v3

- name: Set up Git
run: |​
git config --global user.name "GitHub Actions"
git config --global user.email "actions@github.com"

- name: Extract version from commit hash
id: version
run: echo "::set-output name=version::$(git rev-parse --short HEAD)"

- name: Create a release
if: contains(steps.commit_message.outputs.message, '[v*.*.*]')
uses: actions/create-release@v1
env:
GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
with:
tag_name: commit-${{ steps.version.outputs.version }}
release_name: Release-${{ steps.version.outputs.version }}
body: |​
This release was automatically generated.
Commit: ${{ steps.version.outputs.version }}
draft: false
prerelease: false